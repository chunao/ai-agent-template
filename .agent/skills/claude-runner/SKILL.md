---
name: claude-runner
description: ユーザーの要求やタスクをClaude CLIに委譲して実行するためのスキルです。「Claudeで実行して」「Claudeに聞いて」といった指示や、Claude CLIを使用したタスク実行が必要な場合に使用します。
---

# Claude Runner

このスキルは、ユーザーの要求や特定のタスクを `claude` CLIツールに委譲して実行するためのものです。

## 手順

このスキルが呼び出された場合、以下の手順に従ってコマンドを実行してください。

1.  **トリガーテキストの特定**: スキルの呼び出し元となったユーザーの要求、またはタスクの説明文を特定します。
2.  **コマンドの実行**: 特定したテキストを引数として、以下の形式でコマンドを実行します。

    ```powershell
    claude --print "ここにトリガーした文章を入力"
    ```

    *   **注意**: テキスト内に二重引用符 (`"`) が含まれる場合は、適切にエスケープ（例: `\"`）してください。
    *   **例**:
        *   ユーザー入力: "Claudeでバグを見つけて"
        *   実行コマンド: `claude --print "バグを見つけて"`
        *   ユーザー入力: "Refactor this code using Claude"
        *   実行コマンド: `claude --print "Refactor this code"`

## 運用ルール

*   **`--print`フラグの必須性**: 非対話的な実行（ワンショット実行）を行うため、`--print`フラグは**絶対に削除しないでください**。これを削除するとプロセスが入力待ちとなり、ハングします。
*   **定期的な監視とタイムアウト**:
    *   タスクの完了には時間がかかる場合があります（特にアーカイブ作成や分析など）。
    *   **少なくとも120秒**は、ユーザーへの待機確認（`notify_user`）を行わずに監視を続けてください。
    *   `command_status` ツールを**5秒おき（必須）**に呼び出し、終了コードが返ってくるまで監視を継続します。
*   **トラブルシューティング（スタックしたプロセスの自動終了）**:
    *   コマンドが反応しない、または極端に遅い場合、バックグラウンドで古い `claude` プロセスがスタックしている可能性があります。
    *   ユーザーに尋ねる前に、**10分以上** 実行され続けている古いプロセスがないか確認し、あれば自動的に終了（キル）してください。
        *   確認コマンド例: `Get-Process claude | Where-Object { $_.StartTime -lt (Get-Date).AddMinutes(-10) }`
        *   強制終了コマンド例: `Get-Process claude | Where-Object { $_.StartTime -lt (Get-Date).AddMinutes(-10) } | Stop-Process -Force`
    *   プロセスを終了した場合は、その旨をユーザーに事後報告してください（「応答のない古いバックグラウンドプロセスを終了しました」等）。
*   **代替実行の禁止**: `claude`への委譲が失敗した、あるいは時間がかかっていると判断して、**勝手に次のSKILL（や別の手段）を代わりに実行することは禁止**します。
    *   進捗が見えない等の理由で不安になった場合でも、自己判断で処理を中断したり切り替えたりせず、ユーザーに状況（「まだ実行中です」等）を報告してください。
*   実行結果はターミナルに出力されます。その出力を確認し、必要に応じてユーザーに報告してください。
