# テストルール

以下のテストルールを遵守してください。

## 基本原則

### TDD (テスト駆動開発)

1. **RED**: まず失敗するテストを書く
2. **GREEN**: テストを通す最小限のコードを書く
3. **REFACTOR**: コードを改善する

### テストカバレッジ

- **目標**: 80%以上
- **必須**: 重要なビジネスロジック
- **推奨**: ユーティリティ関数、エッジケース

## テストの書き方

### 命名規則

```
test_<テスト対象>_<条件>_<期待結果>
```

例: `test_user_login_with_valid_credentials_returns_token`

### AAA パターン

```python
def test_example():
    # Arrange - 準備
    user = create_test_user()

    # Act - 実行
    result = user.login("password")

    # Assert - 検証
    assert result.is_success
```

### テストの独立性

- 各テストは他のテストに依存しない
- テストの実行順序に依存しない
- 共有状態を避ける

## テストの種類

| 種類 | 目的 | カバレッジ目標 |
|------|------|---------------|
| 単体テスト | 個々の関数・メソッド | 80%以上 |
| 統合テスト | モジュール間連携 | 重要パス |
| E2Eテスト | ユーザーシナリオ | クリティカルパス |

## テスト要否の判断基準

PR作成前にテストを実行すべきかどうかの判断基準です。

| ファイルタイプ | テスト実行 | 備考 |
|--------------|----------|------|
| `*.py`, `*.js`, `*.ts`, `*.jsx`, `*.tsx` | 必須 | コードロジック変更 |
| `.github/workflows/*.yml` | 必須 | CI/CD設定は動作確認必要 |
| `pyproject.toml` | 必須 | 依存関係変更の影響確認 |
| `*.md`, `*.json`, `*.yaml` | 不要 | ドキュメント/設定ファイル |
| `.claude/**/*.md` | 不要 | ワークフロー定義 |

> **注意**: GitHub Actions が `paths` フィルターで自動判定しますが、ローカルでも事前にテストを実行することを推奨します。

## 禁止事項

- テストなしで実装を進めること
- テストをスキップしたままマージすること
- 本番データを使ったテスト
