---
title: Claude Code の集中力を保つ Agent Skills を作った
url: https://zenn.dev/cureapp/articles/c5016035a7d53d
captured_at: 2026-01-21
published_at: 2025-01-21
---

# Claude Code の集中力を保つ Agent Skills を作った

## TL;DR & Key Conclusions
Claude Code の Agent Skills として Progressive Workflow を公開。複数の指示をまとめて渡すと精度が落ちる問題を、1 ステップずつ指示を分けて渡すことで解決するツール。LLM の「注意力（Attention）」の分散という構造的な問題に対処する。

- **注意力の分散を防ぐ**: 長い指示では Claude が中間の要件を見落としやすいが、1 ステップずつ渡すことで各タスクに集中できる
- **段階的ワークフロー**: 定型的なワークフローを 1 ステップずつ自動で順番に実行する Agent Skills
- **セキュリティレビューの精度向上**: 8 つの観点を一度に渡すのではなく、1 観点ずつ深くレビューできる
- **コードレビュー以外にも適用可能**: 調査タスク、リファクタリング、TDD など段階的な作業に有効
- **視界を絞る設計**: Claude には現在のステップの指示だけが見えるため、全集中できる
- **定型作業の自動化**: 手動で繰り返していた段階的タスクを自動化し、精度を維持

## Quickstart
1. **マーケットプレイスを追加**: `/plugin marketplace add 7tsuno/claude-plugins`
2. **プラグインをインストール**: `/plugin install progressive-workflow`
3. **ワークフローディレクトリを作成**: プロジェクトに `workflows/` ディレクトリを作成
4. **ワークフローを定義**: `workflows/code-review/workflow.yaml` と各ステップの prompt ファイルを作成
5. **実行**: `/progressive-workflow` コマンドまたは自然言語で「code-review ワークフローを実行して」と指示

## Context & Claims (Claim-Evidence-Caveat)
- **Claim**: 複数の指示をまとめて渡すと Claude の精度が落ちる
    - **Evidence**: セルフコードレビューで 8 つの観点（実装完了度、一貫性、パフォーマンス、エラーハンドリング、セキュリティ、lint、テスト、ドキュメント）を一度に渡すと、後半の観点が明らかに内容が薄くなる。細かい条件を無視したり、表面的な修正で終わることがある
    - **Caveat**: Claude の能力不足ではなく、LLM の構造的な特性（入力が長くなるほど中間の指示を見落としやすくなる）

- **Claim**: 1 観点ずつ指示すると精度が明らかに違う
    - **Evidence**: セキュリティの確認だけを頼むと、Claude はセキュリティのことだけを考え、SQL インジェクションや認証の抜け穴をちゃんと見つける。8 つの観点を 8 回繰り返せば、それぞれで深いレビューができる
    - **Caveat**: 手動で毎回繰り返すのは面倒なため、自動化の仕組みが必要

- **Claim**: Progressive Workflow は Claude の視界を絞ることで本来の深さを引き出す
    - **Evidence**: ワークフローを定義しておくと、1 ステップずつ順番に指示を渡す。セキュリティレビューのステップでは、Claude にはセキュリティの指示だけが見え、他の観点は次のステップまで渡されない
    - **Caveat**: 定型化されたワークフローに適しており、柔軟な対応が必要な場合は向いていない可能性がある

## Code Snippets
- **workflow.yaml 定義**: ワークフローの名前、説明、引数、ステップを定義。各ステップは名前と prompt ファイルのパスを指定
- **ステップ別プロンプト**: 各ステップの確認観点とタスクを記述（例: 05-security.md では SQL インジェクション、XSS、CSRF、認証・認可、機密情報のハードコード、入力値のバリデーションを確認）
- **インストールコマンド**: マーケットプレイス追加とプラグインインストールの 2 コマンド

## Normalized Conditions
- **Use Cases**:
    - 複数の観点でコードレビューを行いたい場合（実装完了度、一貫性、パフォーマンス、セキュリティなど）
    - 定型化されたワークフローを繰り返し実行する場合
    - 調査系タスクで「課題の明確化 → ドキュメント調査 → ソースコード調査」のように曖昧な依頼を分割したい場合
    - リファクタリングの連鎖（不要なインポート → 型定義整理 → ロジック共通化）を確実に行いたい場合
    - TDD の補助（テストコード作成 → 実装 → テスト通過）のサイクルを 1 ステップずつ強制したい場合
- **Anti-Cases**:
    - 一度にすべてを俯瞰して判断する必要がある柔軟なタスク
    - 非定型的でワークフローを事前に定義できない作業
    - 1 つの観点だけで十分な単純なタスク
- **Prerequisites**:
    - Claude Code 環境
    - プラグイン機能が使える環境
    - ワークフローを定義するための YAML と Markdown ファイルの作成
- **Decision Triggers**:
    - セルフコードレビューで後半の観点が薄くなっていると感じたとき
    - 複数の指示を手動で繰り返し実行している定型作業があるとき
    - Claude に細かい条件を無視されることが多いとき
- **Failure Modes / Risks**:
    - ワークフローの定義が不適切だと、期待した効果が得られない
    - ステップ間の依存関係が複雑な場合、順番に実行するだけでは対応できない可能性
    - 各ステップの粒度が大きすぎると、注意力の分散問題が再発する
- **Operational Cost**:
    - 初回のワークフロー定義にかかる時間（YAML とプロンプトファイルの作成）
    - 各ステップを順番に実行するため、一度にまとめて実行するより時間がかかる可能性
    - ワークフローの保守・更新コスト
