---
title: Claude Code 技術仕様・制限の完全ガイドとベストプラクティス
url: https://note.com/yuho_walker/n/neb9e4ed3340c
captured_at: 2026-01-25
published_at: 2026-01-09
---

# Claude Code 技術仕様・制限の完全ガイドとベストプラクティス

## TL;DR & Key Conclusions

Claude Codeを実戦で使う際の制限構造とトークン最適化戦略を解説した記事。5時間リミットと週間リミットの2層構造を理解し、コンテキスト管理コマンドを適切に使うことで、仕事を止めずに使い続けられる。

- **2層のレート制限**: 5時間ローリングウィンドウと週間制限があり、Claude.aiとClaude Codeは同一使用量プールを共有
- **Pro vs Max**: トークン消費量が5〜20倍異なる。Opus 4.5はSonnetの約1.7倍のトークンを消費
- **週間制限は2025年8月導入**: パワーユーザーの数万ドル消費に対応。ユーザーの5%未満に影響
- **コンテキスト管理3コマンド**: `/clear`（完全削除）、`/compact`（要約・圧縮）、`/context`（使用量可視化）
- **サブエージェントの特性**: コンテキストは独立するが、トークン消費は同一プールで共有される
- **公式推奨ワークフロー**: Explore, Plan, Code, Commitの4ステップ
- **トークン節約習慣**: タスク完了ごとに`/clear`、コンテキスト70%で`/compact`実行
- **平均コスト**: 開発者1人あたり約$6/日、90%のユーザーは$12/日以下
- **CLAUDE.md推奨フォーマット**: 150-200命令以下に抑える
- **並列実行のトレードオフ**: サブエージェント5個並列で作業時間は半減するが、トークン消費は5倍速
- **MCP無効化**: 使用していないMCPサーバーはコンテキストを消費するため無効化推奨
- **思考の深さ調整**: 「think」<「think hard」<「think harder」<「ultrathink」の順で思考深度を制御可能

## Quickstart

該当なし（概念的な記事）

## Context & Claims (Claim-Evidence-Caveat)

- **Claim**: Claude Codeには5時間ローリングウィンドウ制限と週間制限の2層構造がある
    - **Evidence**: 2025年8月28日より週間制限が追加導入された。最初のメッセージ送信時からカウント開始の5時間ローリングウィンドウと、週間制限が併存
    - **Caveat**: 週間制限の「時間」の正確なトークン換算、Max 20xの実際の倍率については公式発表と実際の挙動に差異がある可能性。Max版はProの約6倍という報告あり

- **Claim**: Claude.aiとClaude Codeは同じ使用量プールを共有する
    - **Evidence**: 公式ドキュメントにて明記。Webでの会話もClaude Codeでの作業も同一カウントで消費
    - **Caveat**: 両方を併用する場合はトークン消費が加速するため要注意

- **Claim**: 週間制限はユーザーの5%未満にしか影響しない
    - **Evidence**: Anthropic公式による発表。24時間365日バックグラウンドで継続使用し数万ドル相当を消費していた一部パワーユーザーへの対応
    - **Caveat**: 特になし

- **Claim**: 開発者1人あたりの平均コストは約$6/日で、90%のユーザーは$12/日以下
    - **Evidence**: Anthropic公式データに基づく統計値
    - **Caveat**: 使用モデル、コードベースのサイズ、並列インスタンス数などにより大きく変動

- **Claim**: `/reset`と`/summary`は公式コマンドとして存在しない
    - **Evidence**: 公式ドキュメントには記載なし。それぞれ`/clear`と`/compact`が同等機能を提供
    - **Caveat**: 特になし

- **Claim**: サブエージェントはコンテキストは独立するが、トークン消費は同一プールで共有される
    - **Evidence**: サブエージェントは独自のコンテキストウィンドウで動作し、作業完了後に結果のみを親エージェントに返す。ただしトークン消費は5時間/週間プールで共有
    - **Caveat**: 5つのサブエージェントを並列実行すると消費レートも5倍になる。順次処理30分→並列15分にできるが、消費レートは2倍

- **Claim**: CLAUDE.mdは150-200命令以下に抑えることが推奨される
    - **Evidence**: 公式ドキュメントにおける推奨事項
    - **Caveat**: 必須フォーマットではない。プロジェクトの複雑性に応じて調整可能

- **Claim**: Opus 4.5はSonnetの約1.7倍のトークンを消費する
    - **Evidence**: 公式資料に基づく倍率
    - **Caveat**: 実際の消費量はタスクの複雑性により変動

- **Claim**: コンテキストが95%に達すると自動的にコンパクトが実行される
    - **Evidence**: 公式仕様として実装
    - **Caveat**: 70%程度に達した時点で手動実行することが推奨されている

- **Claim**: SKILL.mdはProgressive Disclosure設計により、起動時は全スキルのnameとdescriptionのみ読み込む
    - **Evidence**: 公式ドキュメントにおける設計仕様。必要時に該当スキルのSKILL.mdを読み込む
    - **Caveat**: `.claude/skills/`ディレクトリに配置する必要がある

- **Claim**: 思考の深さは「think」<「think hard」<「think harder」<「ultrathink」の順で調整可能
    - **Evidence**: 公式推奨ワークフローにおける拡張思考モードのトリガー仕様
    - **Caveat**: トークン消費も増加する

## Code Snippets

- **CLEARコマンド使用例**: 会話履歴を完全削除してタスク切り替え時にコンテキストをリセット
- **COMPACTコマンド使用例**: 会話履歴を要約・圧縮して重要情報を保持しながらトークン削減
- **CONTEXTコマンド使用例**: コンテキスト使用量をカラーグリッドで可視化
- **CLAUDE.md推奨フォーマット**: プロジェクト概要、コマンド、コードスタイル、禁止事項を150-200命令以下で記述
- **SKILL.md基本構造**: name、descriptionをYAMLフロントマターで定義し、タスク向け能力拡張を記述

## Normalized Conditions

- **Use Cases**:
    - Claude Codeを実戦で本格利用しており、週間リミットに達するリスクがある場合
    - トークン消費を最適化して、Proプランで効率的に運用したい場合
    - サブエージェントの並列実行により作業を高速化したいが、トークン消費を管理したい場合
    - コンテキストウィンドウの肥大化により動作が遅くなっている場合
    - CLAUDE.mdやSKILL.mdの適切な設計方法を知りたい場合
    - 公式推奨ワークフローを理解して実践したい場合

- **Anti-Cases**:
    - Claude Codeを試用レベルでしか使っておらず、リミットに達したことがない場合
    - トークン消費を全く気にせず、Maxプランで無制限に使える環境がある場合
    - サブエージェントや並列実行を使用していない単純なタスクのみの場合

- **Decision Triggers**:
    - 週間リミットに初めて達した、または達しそうになった時
    - Proプランで運用しており、トークン効率を最大化したい時
    - コンテキストが70%を超えて、応答速度が低下し始めた時
    - CLAUDE.mdやSKILL.mdの設計を見直したい時
    - サブエージェントを活用した並列ワークフローを導入したい時
