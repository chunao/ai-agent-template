---
title: Claude Codeの並列実行を効率化する管理アプリを作った
url: https://zenn.dev/akino/articles/4e1b949594b6ca
captured_at: 2026-01-21
published_at: 2025-01-21
---

# Claude Codeの並列実行を効率化する管理アプリを作った

## TL;DR & Key Conclusions
Claude Codeの並列セッション実行時の「見えない待機時間」を解消するため、リアルタイム監視ダッシュボード「Claude Code Monitor」を自作。Claude Code Hooksを活用してイベントを収集し、WebSocketでWebUIに即座に反映することで、複数セッションの状態を一元管理し、エージェントの入力待ち状態を可視化する。

- **並列運用のボトルネックは人間の応答速度**: AIエージェントの能力向上により、人間の応答待ちがシステム全体の遅延要因となる
- **見えない待機時間の解消**: 複数セッションを並列実行する際、どのセッションが停止しているか把握しづらい問題を可視化により解決
- **3〜4並列が最適**: 並列数を増やしすぎるとコンテキストスイッチのコストが増え、逆に効率が低下
- **効率が2〜3倍向上**: リアルタイム可視化により、エージェントの待機時間をほぼゼロにし、体感で2〜3倍の効率向上を実現
- **人間側のワークフロー最適化が重要**: AIエージェントを並列活用する際、人間側のワークフローを最適化する視点が差を生むポイント
- **Claude Code Hooksを活用**: PreToolUse、PostToolUse、Notification、Stopの各イベントを収集し、セッション状態を管理
- **3層アーキテクチャ**: Hook（シェルスクリプト）、バックエンド（Hono）、フロントエンド（React）で構成
- **WebSocketによるリアルタイム配信**: セッション状態が即座にダッシュボードに反映される
- **iTerm2との統合**: クリックで該当タブへ即座にフォーカス可能
- **ステータス可視化**: 実行中・入力待ち・完了のステータスを一目で把握可能

## Quickstart
該当なし（ツールの公開予定はなく、アイデア共有を目的とした記事）

## Context & Claims (Claim-Evidence-Caveat)
- **Claim**: 並列運用の課題は「見えない待機時間」である
    - **Evidence**: 複数のセッションを並列実行すると、どのセッションが入力待ちかわからず、エージェントが待機状態のまま時間が過ぎる
    - **Caveat**: セッション数が増えるほど、この問題は顕著になる

- **Claim**: AIエージェントの能力向上により、ボトルネックが人間側に移る
    - **Evidence**: 従来の開発ではビルドやテスト待ちが生産性を下げていたが、AIエージェント活用時は人間の応答待ちがボトルネックとなる
    - **Caveat**: エージェントはコードを高速に生成するが、確認依頼や質問への応答は人間にしかできない

- **Claim**: 可視化により並列運用の効率が2〜3倍向上
    - **Evidence**: 筆者は3〜4タスクを同時進行できるようになり、エージェントの待機時間をほぼゼロにできた
    - **Caveat**: 体感ベースの評価であり、定量的な測定結果ではない

- **Claim**: 並列数には「ちょうどいい上限」がある
    - **Evidence**: 5つ以上になるとコンテキストスイッチのコストが増え、効率が落ちる。筆者の場合は3〜4並列が限界
    - **Caveat**: 個人差があり、筆者の経験に基づく主観的な判断

- **Claim**: Claude Code Hooksを活用してイベント収集が可能
    - **Evidence**: PreToolUse、PostToolUse、Notification、Stopの各イベントからセッション情報を取得できる
    - **Caveat**: Claude Code Hooksの仕様に依存するため、変更があれば修正が必要

- **Claim**: WebSocketによるリアルタイム配信が効果的
    - **Evidence**: バックエンドからブラウザへライブ更新することで、セッション状態の変化を即座に反映できる
    - **Caveat**: WebSocket接続が切れた場合、リアルタイム性が失われる

- **Claim**: iTerm2との統合により効率的な切り替えが可能
    - **Evidence**: ダッシュボードからクリックで該当タブへフォーカスできる
    - **Caveat**: iTerm2以外のターミナルでは実装が異なる可能性がある

## Code Snippets
- **Claude Code Hooks設定**: PreToolUse、PostToolUse、Notification、Stopの各イベントに対してmonitor-hook.shを実行するHooks設定。セッション状態をバックエンドに送信するために使用

## Normalized Conditions
- **Use Cases**:
    - Claude Codeで複数のタスクを並列実行する開発環境
    - チーム開発でAIエージェントを活用する場合
    - 複数のセッションの状態を一元管理したい場合
    - エージェントの待機時間を最小化したい場合
- **Anti-Cases**:
    - シングルタスクのみを実行する場合
    - Claude Code以外のAIツールを使用する場合
    - 並列実行しない開発スタイル
- **Prerequisites**:
    - Claude Code
    - Claude Code Hooks機能
    - iTerm2（ターミナル統合機能を使う場合）
    - Hono（バックエンド）
    - React（フロントエンド）
    - WebSocket対応ブラウザ
- **Decision Triggers**:
    - 3タスク以上の並列実行を開始したとき
    - エージェントの待機時間が頻繁に発生するとき
    - 複数セッションの状態把握が困難になったとき
- **Failure Modes / Risks**:
    - 並列数を増やしすぎるとコンテキストスイッチのコスト増大
    - WebSocket接続が不安定な場合、リアルタイム性が失われる
    - iTerm2以外のターミナルでは統合機能が使えない可能性
    - Claude Code Hooksの仕様変更による動作不良
- **Operational Cost**:
    - 3層アーキテクチャ（Hook、バックエンド、フロントエンド）のセットアップと運用
    - ダッシュボードの常時表示によるリソース消費
    - Hooks設定の維持管理
