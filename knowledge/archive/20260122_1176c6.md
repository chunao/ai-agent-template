---
title: Claude Code Permissions設定の管理ガイド
url: https://zenn.dev/rehabforjapan/articles/claude-code-permissions-202601
captured_at: 2026-01-22
published_at: 2026-01-20
---

# Claude Code Permissions設定の管理ガイド

## TL;DR & Key Conclusions

Claude Codeのpermissions設定を定期的に棚卸しすることで、AIの自走性を高め、セキュリティリスクを低減できる。設定は3つの階層（ユーザ・プロジェクト・ローカル）に分かれており、それぞれの役割に応じて適切に管理することが重要。

- **3階層の設定ファイル**: ユーザ設定（`~/.claude/settings.json`）、プロジェクト設定（`.claude/settings.json`）、ローカル設定（`.claude/settings.local.json`）の3つがあり、適用範囲と共有対象が異なる
- **allow/denyによる制御**: `permissions`オブジェクト内で許可・拒否するツールとコマンドをパターンで指定できる
- **ワイルドカード対応（v2.1.0以降）**: `*`を使った前方一致・後方一致・前方+後方一致パターンが利用可能
- **定期的な棚卸しが重要**: ローカル設定に一時的なコマンドが溜まりがちなため、定期的な整理を推奨
- **自動化ツールの活用**: `/permissions-audit`スキルで棚卸し作業を自動化可能

## Quickstart

1. **設定ファイルの確認**: 以下の3つのファイルの存在と内容を確認する
   - `~/.claude/settings.json`（ユーザ設定）
   - `.claude/settings.json`（プロジェクト設定）
   - `.claude/settings.local.json`（ローカル設定）

2. **permissions構造の設定**: `allow`と`deny`配列にツール名とパターンを記述
   ```json
   {
     "permissions": {
       "allow": ["Bash(npm run lint)", "Bash(npm run test:*)"],
       "deny": ["Bash(curl:*)", "Read(./.env)"]
     }
   }
   ```

3. **棚卸しの実施**: 各設定ファイルを役割に応じて整理
   - ユーザ設定 → 汎用的な読み込み系コマンド
   - プロジェクト設定 → プロジェクト固有のコマンド
   - ローカル設定 → 一時的なコマンドのみ（定期的に削除）

4. **自動化ツールの導入（任意）**:
   ```bash
   claude plugin marketplace add https://github.com/makikub/claude-code-plugin
   claude plugin install permissions-audit@makikub-plugins
   ```

## Context & Claims (Claim-Evidence-Caveat)

- **Claim**: 3つの設定ファイルを適切に使い分けることでチーム開発とセキュリティを両立できる
    - **Evidence**: ユーザ設定は全プロジェクト共通、プロジェクト設定はチーム共有（ソース管理対象）、ローカル設定は個人用（ソース管理対象外）と役割が明確に分離されている
    - **Caveat**: 設定の優先順位や競合時の挙動については記事内で明示されていない

- **Claim**: ワイルドカードパターンを活用することで柔軟なコマンド制御が可能
    - **Evidence**: `Bash(npm *)`で前方一致、`Bash(* install)`で後方一致、`Bash(git * main)`で前方+後方一致のパターンが使える
    - **Caveat**: v2.1.0以降でのみ利用可能。それ以前のバージョンでは完全一致のみ

- **Claim**: ローカル設定ファイルは定期的な棚卸しが必要
    - **Evidence**: 一時的なテストコマンドや実験的な設定が蓄積しやすい性質がある
    - **Caveat**: 棚卸し頻度の具体的な目安は示されていない

## Code Snippets

- **基本的なpermissions設定**: `allow`と`deny`でツールの許可・拒否を指定する基本構造
```json
{
  "permissions": {
    "allow": [
      "Bash(npm run lint)",
      "Bash(npm run test:*)",
      "Read(~/.zshrc)"
    ],
    "deny": [
      "Bash(curl:*)",
      "Read(./.env)"
    ]
  }
}
```

- **自動化ツールのインストール**: permissions-auditスキルを導入するコマンド
```bash
claude plugin marketplace add https://github.com/makikub/claude-code-plugin
claude plugin install permissions-audit@makikub-plugins
```

## Normalized Conditions

- **Use Cases**:
    - チーム開発でClaude Codeのコマンド実行権限を統一したい場合
    - セキュリティ上、特定のコマンド（curl、envファイル読み込みなど）を制限したい場合
    - AIの自走性を高めつつ、安全なコマンドのみ自動実行させたい場合
    - 複数プロジェクトで共通の設定を維持したい場合

- **Anti-Cases**:
    - Claude Codeを初めて使う段階（まずはデフォルト設定で慣れるべき）
    - 個人開発で権限制御の必要性が低い場合
    - 頻繁にコマンドを変更する実験フェーズ（都度設定変更が煩雑）

- **Decision Triggers**:
    - チームメンバーが増え、Claude Codeの利用ルールを統一する必要が出たとき
    - 機密情報を扱うプロジェクトでセキュリティ要件が厳しくなったとき
    - ローカル設定ファイルが肥大化し、不要な許可設定が溜まってきたと感じたとき
    - v2.1.0以降にアップデートし、ワイルドカード機能を活用したいとき
